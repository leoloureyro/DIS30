<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>DIS30 | FADU UBA</title>
    <link rel="stylesheet" href="https://use.typekit.net/hkc8zia.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <script src="https://kit.fontawesome.com/a171b4c332.js"></script>
  </head>

  <body>
    <div id="big-loader" style="opacity: 1;">
      <img src="src/logo.svg">
      <p id="loading"></p>
    </div>

    <div class="vhs-noise"></div>
    <header>
      <nav>
        <div>
          Faltan <span id="dias">--</span>días
          <span id="hs">--</span>hs
          <span id="mins">--</span>m
          <span id="segs">--</span>s
        </div>
        <div id="menu">
          <a id="sandwitch">
            MENU
            <span style="font-size:0.8em;">
              <i class="fas fa-bars"></i>
            </span>
          </a>
          <div id="menu-items">
            <img src="src/logo.svg">
            <ul>
              <li><a href="#historia">Historia</a></li>
              <li><a href="#cronograma">Cronograma</a></li>
              <li><a href="#contacto">Contacto</a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <section id="inicio">
      <!-- ESCENA ANIMADA -->
      <div id="splash">
        <div id="wall" depth="17"></div>
        <!-- TÍTULOS DE SECCIONES -->
        <p class="section-holder camera">Un poco de<br><span class="big">HISTORIA</span></p>
        <p class="section-holder vhs">Cronograma de<br><span class="big">ACTIVIDADES</span></p>
        <p class="section-holder recorder">Mantenete en<br><span class="big">CONTACTO</span></p>
        <!-- ELEMENTOS DE LA ESCENA -->
        <div class="scene-element" id="camera" depth="12" rotation="-20">
          <a href="#historia">
            <img src="src/camera.png" class="object">
            <img src="src/camera-overlay.png" class="neon-glow">
          </a>
        </div>
        <div class="scene-element" id="vhs" depth="5" rotation="-25">
          <a href="#cronograma">
            <img src="src/vhs.png">
            <img src="src/vhs-overlay.png" class="neon-glow">
          </a>
        </div>
        <div class="scene-element" id="recorder" depth="2" rotation="10">
          <a href="#contacto">
            <img src="src/recorder.png">
            <img src="src/recorder-overlay.png" class="neon-glow">
          </a>
        </div>
      </div>
      <!-- CUENTA REGRESIVA -->
    </section>
    <hr class="iridiscent">
    <section id="historia">
      <h2>AÑO 1989</h2>
      <slideshow id="a1989" controls thumbnails>
        <slide>
          <img src="src/afiches/fadu.jpg" style="transform:rotate(-1deg);">
          <p>
            <span class="slide-title">DISEÑO DE IMÁGEN Y SONIDO</span><br>
            <br>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus quis cursus odio, vitae condimentum nunc. Sed facilisis sollicitudin eros et luctus. Phasellus sed nulla ac urna feugiat aliquet eget ut velit. Praesent sit amet ex nec justo semper hendrerit ac bibendum nisl. Donec at neque mattis, tincidunt ex et, porttitor tortor.
          </p>
        </slide>
        <slide>
          <img src="src/afiches/bttf2.jpg">
          <p>
            <span class="slide-title" style="transform:rotate(2deg);">BACK TO THE FUTURE II</span><br>
            <br>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus quis cursus odio, vitae condimentum nunc. Sed facilisis sollicitudin eros et luctus. Phasellus sed nulla ac urna feugiat aliquet eget ut velit. Praesent sit amet ex nec justo semper hendrerit ac bibendum nisl. Donec at neque mattis, tincidunt ex et, porttitor tortor.
          </p>
        </slide>
      </slideshow>
    </section>
    <section id="cronograma">

    </section>

    <script type="text/javascript" src="js/Loaders.js"></script>
    <script type="text/javascript" src="js/Scene.js"></script>
    <script type="text/javascript" src="js/Slideshow.js"></script>
    <script type="text/javascript">
      HTMLElement.prototype.animateTo = function (property, durationMs, timingFunction = "ease", fillMode = "forwards") {
        let from = {};
        let to = {};
        for(let prop in property){
          from[prop] = window.getComputedStyle(this, null).getPropertyValue(prop) || this.style.prop || undefined;
          to[prop] = property[prop];
        };
        this.animate([from, to], {
          duration: durationMs,
          easing: timingFunction,
          fill: fillMode
        });

        return this;
      }

      // MENU
      const sandwitch = document.querySelector("#sandwitch");
      const menu = document.querySelector("#menu");

      sandwitch.addEventListener("click", ()=>{
        menu.classList.add("active");
      })
      menu.addEventListener("mouseleave", ()=>{
        menu.classList.remove("active");
      });

      // CONVERTIR EL SPLASH EN UNA ESCENA
      var scene = new Scene("splash");

      // ANIMAR TITULOS DINÁMICOS PARA EL SPLASH
      const splashElements = document.getElementsByClassName("scene-element");
      for(let elem of splashElements){
        elem.addEventListener("mouseover", function(){
          let element = this.getAttribute("id");
          document.querySelector(`.section-holder.${element}`).classList.add("active");
        });
        elem.addEventListener("mouseout", function(){
          let element = this.getAttribute("id");
          document.querySelector(`.section-holder.${element}`).classList.remove("active");
        });
      }

      // CUENTA REGRESIVA
      var countDown = new Date("Oct 10, 2019 00:00:00").getTime();
      var x = setInterval(function() {
        let ahora = new Date().getTime();
        let distancia = countDown - ahora;
        let dias = Math.floor(distancia / (1000 * 60 * 60 * 24));
        let horas = Math.floor((distancia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        let minutos = Math.floor((distancia % (1000 * 60 * 60)) / (1000 * 60));
        let segundos = Math.floor((distancia % (1000 * 60)) / 1000);

        document.getElementById("dias").textContent = dias;
        document.getElementById("hs").textContent = horas;
        document.getElementById("mins").textContent = minutos;
        document.getElementById("segs").textContent = segundos;

        if (distancia < 0) {
          clearInterval(x);
          document.getElementById("hs").textContent = "00";
          document.getElementById("mins").textContent = "00";
          document.getElementById("segs").textContent = "00";
        }
      }, 1000);

      // LOADER
      const loader = new ImgLoader();
      const loaderElement = document.getElementById("big-loader");

      loader.onChange = function(){
        console.log(`cargando ${loader.percentage}%`);
        loaderElement.querySelector("#loading").textContent = `cargando ${loader.percentage}%`;
      }
      loader.onLoad = function(){
        loaderElement.querySelector("#loading").textContent = "presenta";
        loaderElement.classList.add("loaded");
        setTimeout(function(){
          loaderElement.style.pointerEvents = "none";
          loaderElement.animateTo({"opacity": "0"}, 1000);
          setTimeout(function(){
            loaderElement.style.display = "none";
          }, 1000)
        }, 1000);
      };
      loader.init();

      // SHADERS
      var vhsAnimation;
      const vhsNoise = document.querySelector(".vhs-noise");
      window.addEventListener("scroll", () => {
        clearTimeout(vhsAnimation);
        vhsNoise.style.display = "block";
        vhsAnimation = setTimeout(function(){
          vhsNoise.style.display = "none";
        }, 500);
      })

      // SMOOTH SCROLL
    	var links = document.getElementsByTagName('a');
      var scrollAction;
      var bodyScroll;
      for(let link of links){
        let target = link.getAttribute("href") || "";
        if(target.startsWith("#")){
          link.addEventListener("click", function(e){
            e.preventDefault();
            scrollAction = setInterval(function(){
              let scrollTarget = Math.trunc(document.querySelector(target).getBoundingClientRect().top);
              scrollToTarget(scrollTarget);
            }, 10);
          })
        }
      }
      function scrollToTarget(t){
        let scrollPos = window.scrollY || window.pageYOffset;
        if(bodyScroll != scrollPos){
          bodyScroll = scrollPos;
          if(Math.abs(t) > 10){
            window.scroll(0, Math.round(scrollPos + (t / 10)));
          } else if(Math.abs(t) > 0){
            window.scroll(0, Math.round(scrollPos + (t / Math.abs(t))));
          } else {
            clearInterval(scrollAction);
          }
        } else {
          clearInterval(scrollAction);
        }
      }
    </script>
  </body>
</html>
